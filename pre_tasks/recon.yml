---
# - name: output disk and partition info
#  debug:
#    msg: "{{ item.value.partitions }}"
#  with_dict: "{{ hostvars[inventory_hostname].ansible_devices }}"
#  debug:
#    msg: "{{ hostvars[inventory_hostname].ansible_devices | community.general.json_query()  }}"
#msg: "{{ hostvars[inventory_hostname] | to_json }}"
#var: item
#loop: "{{ hostvars[inventory_hostname] | community.general.json_query('ansible_devices[*].partitions') }}"
#- name: Transfer the script
#  copy: src=../files/scripts/test.sh dest=/root mode=0777
#
#- name: Gathering disks info
#  expect:
#    command: /usr/bin/sh /root/recon.sh
#    responses:
#      "Selec disk:": "/dev/sda"
#  register: outpout
#- debug: msg="{{outpout.stdout_lines}}"

#- name: Transfer the script
#  copy: src=../files/scripts/recon.sh dest=/root mode=0777

- name: Gathering disks info
  script: ../files/scripts/recon.sh

- name: fetching disks info
  fetch:
    src: /tmp/archauto/disk_info.log
    dest: files/logs/disk_info.log
    flat: yes

#- name: Clean artifacts
#  file:
#    state: absent
#    path: "/tmp/disk_info.log"